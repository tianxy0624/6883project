[{"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/index.js":"1","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/serviceWorker.js":"2","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/App.js":"3","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/MyTokens.js":"4","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/MyResales.js":"5","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/Home.js":"6","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/MyAccount.js":"7","/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/Search.js":"8"},{"size":493,"mtime":1651179870714,"results":"9","hashOfConfig":"10"},{"size":4951,"mtime":1651179870714,"results":"11","hashOfConfig":"10"},{"size":4529,"mtime":1651383279909,"results":"12","hashOfConfig":"10"},{"size":5193,"mtime":1651179870713,"results":"13","hashOfConfig":"10"},{"size":5855,"mtime":1651179870713,"results":"14","hashOfConfig":"10"},{"size":5990,"mtime":1651179870713,"results":"15","hashOfConfig":"10"},{"size":2254,"mtime":1651382994190,"results":"16","hashOfConfig":"10"},{"size":4567,"mtime":1651430716037,"results":"17","hashOfConfig":"10"},{"filePath":"18","messages":"19","suppressedMessages":"20","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"a3rvuk",{"filePath":"21","messages":"22","suppressedMessages":"23","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"24","messages":"25","suppressedMessages":"26","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"27","messages":"28","suppressedMessages":"29","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"30","messages":"31","suppressedMessages":"32","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"33","messages":"34","suppressedMessages":"35","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"36","messages":"37","suppressedMessages":"38","errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"39","messages":"40","suppressedMessages":"41","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"42"},"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/index.js",[],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/serviceWorker.js",[],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/App.js",["43","44"],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/MyTokens.js",[],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/MyResales.js",[],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/Home.js",[],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/MyAccount.js",["45","46","47","48"],[],"/Users/xiaoyutian/CUstudy/blockchain/6883project/src/frontend/components/Search.js",["49","50","51"],[],"import { useState, useEffect, useRef } from 'react'\nimport { ethers } from \"ethers\"\nimport Identicon from 'identicon.js';\nimport { Row, Col, Card, Button, InputGroup, Form } from 'react-bootstrap'\n\nexport default function Search({ contract,searchedSong }) {\n  const audioRefs = useRef([]);\n  const [isPlaying, setIsPlaying] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [selected, setSelected] = useState(0)\n  const [previous, setPrevious] = useState(null)\n  const [marketItems, setMarketItems] = useState(null)\n  const [selectedItems, setSelectedItems] = useState(null)\n  const loadMarketplaceItems = async () => {\n    // Get all unsold items/tokens\n    const results = await contract.getAllUnsoldTokens()\n    const marketItems = await Promise.all(results.map(async i => {\n      // get uri url from contract\n      const uri = await contract.tokenURI(i.tokenId)\n      // use uri to fetch the nft metadata stored on ipfs \n      const response = await fetch(uri + \".json\")\n      const metadata = await response.json()\n      const identicon = `data:image/png;base64,${new Identicon(metadata.name + metadata.price, 330).toString()}`\n      // define item object\n      let item = {\n        price: i.price,\n        itemId: i.tokenId,\n        name: metadata.name,\n        audio: metadata.audio,\n        identicon\n      }\n      return item\n    }))\n      setMarketItems(marketItems)\n      const selectedItems = marketItems.filter(i => (i.name.toLowerCase().includes(searchedSong)))\n      setSelectedItems(selectedItems)\n      setLoading(false)\n  }\n\n  const buyMarketItem = async (item) => {\n    await (await contract.buyToken(item.itemId, { value: item.price })).wait()\n    loadMarketplaceItems()\n  }\n  \n  useEffect(() => {\n    if (isPlaying) {\n      audioRefs.current[selected].play()\n      if (selected !== previous) audioRefs.current[previous].pause()\n    } else if (isPlaying !== null) {\n      audioRefs.current[selected].pause()\n    }\n\n  })\n  useEffect(() => {\n    !selectedItems && loadMarketplaceItems()\n  })\n\n  if (loading) return (\n    <main style={{ padding: \"1rem 0\" }}>\n      <h2>Loading...</h2>\n    </main>\n  )\n\n  return (\n    <div className=\"flex justify-center\">\n      {selectedItems.length > 0 ?\n        <div className=\"px-5 container\">\n          <Row xs={1} md={2} lg={4} className=\"g-4 py-5\">\n            {selectedItems.map((item, idx) => (\n              <Col key={idx} className=\"overflow-hidden\">\n                <audio src={item.audio} key={idx} ref={el => audioRefs.current[idx] = el}></audio>\n                <Card>\n                  <Card.Img variant=\"top\" src={item.identicon} />\n                  <Card.Body color=\"secondary\">\n                    <Card.Title>{item.name}</Card.Title>\n                    <div className=\"d-grid px-4\">\n                      <Button variant=\"secondary\" onClick={() => {\n                        setPrevious(selected)\n                        setSelected(idx)\n                        if (!isPlaying || idx === selected) setIsPlaying(!isPlaying)\n                      }}>\n                        {isPlaying && selected === idx ? (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"23\" height=\"23\" fill=\"currentColor\" className=\"bi bi-pause\" viewBox=\"0 0 16 16\">\n                            <path d=\"M6 3.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5zm4 0a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0V4a.5.5 0 0 1 .5-.5z\" />\n                          </svg>\n                        ) : (\n                          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"23\" height=\"23\" fill=\"currentColor\" className=\"bi bi-play\" viewBox=\"0 0 16 16\">\n                            <path d=\"M10.804 8 5 4.633v6.734L10.804 8zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696l6.363 3.692z\" />\n                          </svg>\n                        )}\n                      </Button>\n                    </div>\n                  </Card.Body>\n                  <Card.Footer>\n                  <div className='d-grid my-1'>\n                    <Button onClick={() => buyMarketItem(item)} variant=\"primary\" size=\"lg\">\n                      {`Buy for ${ethers.utils.formatEther(item.price)} ETH`}\n                    </Button>\n                  </div>\n                </Card.Footer>\n                </Card>\n              </Col>\n            ))}\n          </Row>\n        </div>\n        : (\n          <main style={{ padding: \"1rem 0\" }}>\n            <h2>Sorry! We cannot find what you want</h2>\n          </main>\n        )}\n    </div>\n  );\n}",{"ruleId":"52","severity":1,"message":"53","line":11,"column":57,"nodeType":"54","messageId":"55","endLine":11,"endColumn":66},{"ruleId":"52","severity":1,"message":"56","line":12,"column":8,"nodeType":"54","messageId":"55","endLine":12,"endColumn":12},{"ruleId":"52","severity":1,"message":"57","line":1,"column":31,"nodeType":"54","messageId":"55","endLine":1,"endColumn":37},{"ruleId":"52","severity":1,"message":"58","line":3,"column":10,"nodeType":"54","messageId":"55","endLine":3,"endColumn":13},{"ruleId":"52","severity":1,"message":"59","line":3,"column":15,"nodeType":"54","messageId":"55","endLine":3,"endColumn":18},{"ruleId":"60","severity":1,"message":"61","line":32,"column":21,"nodeType":"62","messageId":"63","endLine":32,"endColumn":23},{"ruleId":"52","severity":1,"message":"64","line":4,"column":34,"nodeType":"54","messageId":"55","endLine":4,"endColumn":44},{"ruleId":"52","severity":1,"message":"65","line":4,"column":46,"nodeType":"54","messageId":"55","endLine":4,"endColumn":50},{"ruleId":"52","severity":1,"message":"66","line":12,"column":10,"nodeType":"54","messageId":"55","endLine":12,"endColumn":21},"no-unused-vars","'FormGroup' is defined but never used.","Identifier","unusedVar","'logo' is defined but never used.","'useRef' is defined but never used.","'Row' is defined but never used.","'Col' is defined but never used.","eqeqeq","Expected '===' and instead saw '=='.","BinaryExpression","unexpected","'InputGroup' is defined but never used.","'Form' is defined but never used.","'marketItems' is assigned a value but never used."]